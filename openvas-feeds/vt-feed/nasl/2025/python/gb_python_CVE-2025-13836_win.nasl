# SPDX-FileCopyrightText: 2025 Greenbone AG
# Some text descriptions might be excerpted from (a) referenced
# source(s), and are Copyright (C) by the respective right holder(s).
#
# SPDX-License-Identifier: GPL-2.0-only

CPE = "cpe:/a:python:python";

if(description)
{
  script_oid("1.3.6.1.4.1.25623.1.0.125554");
  script_version("2025-12-04T05:40:45+0000");
  script_tag(name:"last_modification", value:"2025-12-04 05:40:45 +0000 (Thu, 04 Dec 2025)");
  script_tag(name:"creation_date", value:"2025-12-02 17:18:01 +0000 (Tue, 02 Dec 2025)");
  script_tag(name:"cvss_base", value:"5.0");
  script_tag(name:"cvss_base_vector", value:"AV:N/AC:L/Au:N/C:N/I:N/A:P");

  script_cve_id("CVE-2025-13836");

  script_tag(name:"qod_type", value:"remote_banner");

  script_tag(name:"solution_type", value:"VendorFix");

  script_name("Python DoS Vulnerability (Dec 2025) - Windows");

  script_category(ACT_GATHER_INFO);

  script_copyright("Copyright (C) 2025 Greenbone AG");
  script_family("Denial of Service");
  script_dependencies("gb_python_consolidation.nasl", "os_detection.nasl");
  script_mandatory_keys("python/detected", "Host/runs_windows");

  script_tag(name:"summary", value:"Python is prone to a denial of service (DoS) vulnerability.");

  script_tag(name:"vuldetect", value:"Checks if a vulnerable version is present on the target host.");

  script_tag(name:"insight", value:"When reading an HTTP response from a server, if no read amount
  is specified, the default behavior will be to use Content-Length. This allows a malicious
  server to cause the client to read large amounts of data into memory, potentially causing
  out-of-memory (OOM) or other DoS conditions.");

  script_tag(name:"affected", value:"Python prior to version 3.14.1.

  Note: Fixes have been backported to maintenance branches (3.10, 3.12, 3.13) but specific
  patch versions are not yet available.");

  script_tag(name:"solution", value:"Update to version 3.14.1 or later, or to the latest
  maintenance release of your Python version series (3.10.x, 3.12.x, 3.13.x) once patches
  are available. Please see the references for more information.");

  script_xref(name:"URL", value:"https://github.com/python/cpython/issues/119451");
  script_xref(name:"URL", value:"https://github.com/python/cpython/pull/119454");
  script_xref(name:"URL", value:"https://github.com/python/cpython/commit/4ce27904b597c77d74dd93f2c912676021a99155");
  script_xref(name:"URL", value:"https://github.com/python/cpython/commit/5a4c4a033a4a54481be6870aa1896fad732555b5");
  script_xref(name:"URL", value:"https://www.cve.org/CVERecord?id=CVE-2025-13836");

  exit(0);
}

include("host_details.inc");
include("version_func.inc");

if (isnull(port = get_app_port(cpe: CPE)))
  exit(0);

if (!infos = get_app_version_and_location(cpe: CPE, port: port, exit_no_version: TRUE,
                                          version_regex: "^[0-9]+\.[0-9]+\.[0-9]+"))
  exit(0);

version = infos["version"];
location = infos["location"];

# TODO: Check the CVE entry again in 1/2 months to see if additional fixes for older branches have
# been published.
if (version_is_less(version: version, test_version: "3.14.1")) {
  report = report_fixed_ver(installed_version: version, fixed_version: "3.14.1", install_path: location);
  security_message(port: port, data: report);
  exit(0);
}

exit(99);
